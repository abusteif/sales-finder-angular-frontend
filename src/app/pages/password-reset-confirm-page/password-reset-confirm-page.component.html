<div class="password-reset-container">
    <div class="password-reset-card">
        <div class="password-reset-logo">
            <app-logo size="large" variant="default" [showText]="true" [clickable]="true" routerLink="/"></app-logo>
        </div>

        <div class="password-reset-header">
            <h1 class="password-reset-title">Reset Your Password</h1>
            <p class="password-reset-subtitle">Enter your new password below</p>
        </div>

        @if (errorMessage && !token) {
        <div class="error-container">
            <div class="error-message">
                <i class="fas fa-exclamation-triangle"></i>
                <p>{{ errorMessage }}</p>
            </div>
            <button class="request-new-reset-btn" (click)="requestNewReset()">
                Request New Reset
            </button>
        </div>
        } @else {
        <form [formGroup]="passwordResetForm" (ngSubmit)="onSubmit()" class="password-reset-form"
            [class.loading]="isLoading">
            <app-auth-field type="password" label="New Password" placeholder="Enter your new password"
                icon="fas fa-lock" [required]="true" [showPasswordToggle]="true"
                [errorMessage]="getFieldError('password')" formControlName="password">
            </app-auth-field>

            <app-auth-field type="password" label="Confirm New Password" placeholder="Confirm your new password"
                icon="fas fa-lock" [required]="true" [showPasswordToggle]="true"
                [errorMessage]="getFieldError('confirmPassword')" formControlName="confirmPassword">
            </app-auth-field>

            <button type="submit" class="reset-button" [disabled]="passwordResetForm.invalid || isLoading">
                @if (isLoading) {
                <i class="fas fa-spinner fa-spin"></i>
                Resetting Password...
                } @else {
                Reset Password
                }
            </button>

            @if (errorMessage) {
            <p class="error-message">{{ errorMessage }}</p>
            }

            @if (successMessage) {
            <p class="success-message">{{ successMessage }}</p>
            }
        </form>

        @if (isLoading) {
        <div class="loading-overlay">
            <div class="loading-spinner">
                <i class="fas fa-spinner fa-spin"></i>
                <p>Resetting your password...</p>
            </div>
        </div>
        }
        }

        <div class="password-reset-footer">
            <p class="back-to-login-text">
                Remember your password?
                <a (click)="backToLogin()" class="login-link">Sign in</a>
            </p>
        </div>
    </div>
</div>