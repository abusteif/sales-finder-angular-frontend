<app-admin-base-page 
  title="Reset Your Password"
  subtitle="Enter your new password below"
  cardSize="medium"
  [hideNavbar]="true"
  [isLoading]="isLoading"
  loadingMessage="Resetting your password...">

  @if (errorMessage && !token) {
    <div class="error-container">
      <div class="error-message">
        <i class="fas fa-exclamation-triangle"></i>
        {{ errorMessage }}
      </div>
      <button type="button" class="btn btn-secondary btn-full-width" (click)="requestNewReset()">
        Request New Reset
      </button>
    </div>
  } @else {
    <form [formGroup]="passwordResetForm" (ngSubmit)="onSubmit()" class="page-form" [class.loading]="isLoading">
      <app-auth-field 
        type="password" 
        label="New Password" 
        placeholder="Enter your new password"
        icon="fas fa-lock" 
        [required]="true" 
        [showPasswordToggle]="true"
        [errorMessage]="getFieldError('password')" 
        formControlName="password">
      </app-auth-field>

      <app-auth-field 
        type="password" 
        label="Confirm New Password" 
        placeholder="Confirm your new password"
        icon="fas fa-lock" 
        [required]="true" 
        [showPasswordToggle]="true"
        [errorMessage]="getFieldError('confirmPassword')" 
        formControlName="confirmPassword">
      </app-auth-field>

      <button 
        type="submit" 
        class="btn btn-primary btn-full-width" 
        [disabled]="passwordResetForm.invalid || isLoading">
        @if (isLoading) {
          <i class="fas fa-spinner fa-spin"></i>
          Resetting Password...
        } @else {
          Reset Password
        }
      </button>

      @if (errorMessage) {
        <div class="error-message">
          <i class="fas fa-exclamation-circle"></i>
          {{ errorMessage }}
        </div>
      }

      @if (successMessage) {
        <div class="success-message">
          <i class="fas fa-check-circle"></i>
          {{ successMessage }}
        </div>
      }
    </form>
  }

  <div class="admin-page-footer">
    <p class="admin-page-footer-text">
      Remember your password? 
      <button type="button" (click)="backToLogin()" class="admin-page-footer-link">Sign in</button>
    </p>
  </div>

</app-admin-base-page>