@if(item) {

<div
  class="card custom-card"
  [class]="getCardFontSizeClass()"
  [style.box-shadow]="getCardShadowStyle()"
  [style.--hover-shadow]="getCardHoverShadowStyle()"
  (click)="onCardClick($event)"
>
  <div class="card-image" style="align-items: center; display: flex; justify-content: center;">
      @if(updateType !== UpdateType.ALL) {
      <div
        [class]="getIndicatorClass()"
        #tooltip="matTooltip"
        matTooltip="{{ itemTooltip() }}"
        matTooltipPosition="below"
        [matTooltipShowDelay]="0"
        [matTooltipClass]="'custom-tooltip'"
        (click)="onIndicatorClick($event)"
      >
        <i [class]="getIndicatorIcon()"></i>
        {{ getIndicatorText() }}
      </div>
      } @if(shouldShowDiscountIcon()) {
      <div class="discount-container">
        <div
          [class]="getDiscountIconClass()"
          #discountTooltip="matTooltip"
          [matTooltip]="getDiscountIconTooltip()"
          matTooltipPosition="below"
          [matTooltipShowDelay]="isMobile ? 0 : 300"
          [matTooltipClass]="'custom-tooltip'"
          (click)="onDiscountIconClick($event, discountTooltip)"
        >
          {{ getDiscountIconText() }}
        </div>
        @if(shouldShowVolatilityWarning()) {
        <div
          class="volatility-warning-icon"
          #volatilityTooltip="matTooltip"
          [matTooltip]="getVolatilityWarningTooltip()"
          matTooltipPosition="below"
          [matTooltipShowDelay]="isMobile ? 0 : 300"
          [matTooltipClass]="'custom-tooltip'"
          (click)="onVolatilityIconClick($event, volatilityTooltip)"
        >
          <i class="fas fa-exclamation-triangle"></i>
        </div>
        }
      </div>
      } @if(isRRPFluctuating) {
      <div 
        class="rrp-fluctuating-icon"
        #rrpFluctuatingTooltip="matTooltip"
        [matTooltip]="getRRPFluctuatingBadgeTooltip()"
        matTooltipPosition="below"
        [matTooltipShowDelay]="isMobile ? 0 : 300"
        [matTooltipClass]="'custom-tooltip'"
        (click)="onRRPFluctuatingBadgeClick($event, rrpFluctuatingTooltip)"
      >
        <i class="fas fa-arrow-up"></i>
        <span>RRP</span>
        <i class="fas fa-arrow-down"></i>
      </div>
      }
      <figure class="image is-1by1 card-image-figure">
        @if(!imageLoadError) {
        <a
          [href]="getItemDetailsUrl()"
          target="_blank"
          rel="noopener noreferrer"
          (click)="$event.stopPropagation()"
          style="display: block; width: 100%; height: 100%;"
        >
          <img
            [src]="item.imageUrl"
            alt="Card image"
            class="card-image-img"
            (error)="onImageError()"
          />
        </a>
        } @else {
        <div class="no-image-placeholder">
          <i class="fas fa-image"></i>
          <p>No image available</p>
        </div>
        }
      </figure>
  </div>
  <div class="card-content">
    <p 
      [class]="getTitleClass()"
      [matTooltip]="item.name"
      matTooltipPosition="above"
      [matTooltipShowDelay]="700"
    >
      {{ item.name | truncate }}
    </p>
    <div class="rating-container">
      <div class="stars">
        @for(star of getStars(); track $index) {
          @if(star.includes('far')) {
            <i [class]="star"></i>
          } @else {
            <i [class]="star" [style.color]="getStarColor()"></i>
          }
        }
      </div>
      @if(rating > 0) {
      <span class="rating-text">
        {{ rating | number:'1.1-1' }}
        @if(ratingCount > 0) {
          ({{ getFormattedRatingCount() }})
        }
      </span>
      }
    </div>
    <div class="store-logos-container">
      <a [href]="googleUrl" target="_blank" rel="noopener noreferrer" (click)="$event.stopPropagation()">
        <img
          [src]="'assets/logos/google-logo.svg'"
          class="google-logo"
          alt="Google Logo"
        />
      </a>
      <img
        [src]="`assets/logos/${item.store}-logo.svg`"
        class="store-logo"
        alt="Store Logo"
        [matTooltip]="'Last checked: ' + (lastCheckedAt | relativeDate)"
        matTooltipPosition="below"
        [matTooltipShowDelay]="700"
        [matTooltipClass]="'custom-tooltip'"
      />
      @if(item.store === 'amazon') {
      <a [href]="camelCamelCamelUrl" target="_blank" rel="noopener noreferrer" (click)="$event.stopPropagation()">
        <img
          [src]="'assets/logos/camelcamelcamel-logo.png'"
          class="store-logo"
          alt="Store Logo"
        />
      </a>
      }
    </div>
    <div class="pricing-section">
      <div class="prices-container">
        <p class="old-price item-detail">
          <span style="font-weight: bold">RRP: </span>
          <span>${{ item.oldPrice }}</span>
        </p>
        <p class="new-price item-detail">
          <span style="font-weight: bold">New Price: </span>
          <span>${{ item.newPrice }}</span>
        </p>
        <p class="item-detail">
          <span style="font-weight: bold; color: black">Discount: </span>
          <span style="color: black"
            >{{ 100 * item.discount | number : "1.0-0" }}%</span
          >
        </p>
      </div>
      <button
        class="bell-button"
        [class.disabled]="isAlertDisabled()"
        [class.has-alert]="alertId"
        [disabled]="isAlertDisabled()"
        [matTooltip]="getTooltipText()"
        matTooltipPosition="below"
        [matTooltipShowDelay]="700"
        [matTooltipClass]="'custom-tooltip'"
        (click)="onAlertButtonClick($event)"
      >
        <i class="fas fa-bell"></i>
      </button>
      <button
        class="report-button"
        [class.reported]="isReportedForSaleExpiry || isPotentiallyDeleted"
        [matTooltip]="getReportButtonTooltip()"
        matTooltipPosition="above"
        [matTooltipShowDelay]="700"
        [matTooltipClass]="'custom-tooltip'"
        (click)="onReportNoLongerOnDiscountClick($event)"
      >
        <i class="fas fa-exclamation-circle"></i>
      </button>
    </div>
  </div>
</div>
}
